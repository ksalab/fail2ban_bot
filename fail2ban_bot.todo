=================================================================================
| fail2ban Telegram Bot - TODO List
| This file contains the current status of the bot's features and planned tasks.
=================================================================================

Features and tasks:

Main commands and functionality:
  Added the /start command:
    âœ” Welcome message with available commands. @done(25-08-14 10:15)
  Added the /status command:
    âœ” Service state (running/enabled). @done(25-08-14 10:15)
    âœ” Version and uptime (ActiveEnterTimestamp). @done(25-08-14 10:15)
    âœ” SSH jail status via fail2ban-client. @done(25-08-14 10:15)
  Added the /stats command:
    âœ” Period selection (hour, day, week, month, year). @done(25-08-14 10:15)
    âœ” Ban count and comparison with previous period. @done(25-08-14 10:15)
    âœ” Embedded plots in messages. @done(25-08-14 10:15)
  Added the /geo command:
    âœ” World map of banned IPs (via CartoPy). @done(25-08-14 10:15)
    âœ” Unique colors per country with legend. @done(25-08-14 10:15)
    âœ” Geo stats for selected period. @done(25-08-14 10:15)
  Security:
    âœ” Token masking in logs (botXXX:XXX). @done(25-08-14 10:15)
    âœ” Admin-only access via ADMINS list. @done(25-08-14 10:15)

Notifications:
  GeoIP database update notifications:
    âœ” Telegram alert on successful update. @done(25-08-14 10:15)
    âœ” Telegram alert on download/error. @done(25-08-14 10:15)
  Anomaly detection (e.g., >100 bans/hour):
    - Planned: Not implemented. Can trigger high-severity alert.
  Scheduled reports (daily/weekly summary):
    - Planned: Not implemented. Can be added via JobQueue.
  Support for message_thread_id (topic in group):
    âœ” Configurable via .env. @done(25-08-14 10:15)

Data storage:
  GeoIP database (GeoLite2-City.mmdb):
    âœ” Auto-download on startup. @done(25-08-14 10:15)
    âœ” Auto-update every 28 days. @done(25-08-14 10:15)
  IP and geo data caching:
    âœ” In-memory cache (geo_cache). @done(25-08-14 10:15)
  Log file parsing:
    âœ” Read from LOG_FILE path. @done(25-08-14 10:15)
    âœ” Parse ISO and syslog timestamps. @done(25-08-14 10:15)
  Multi-server support:
    - Planned: Add support for monitoring multiple servers.
    âœ” Work with multiple servers will be added, but:
    - Chat remains single (one CHAT_ID).
    - List of servers stored in .env (SERVERS="host1:label1,host2:label2").
    - Log paths can be local or via log aggregation.
    - Messages will include server IP/label for context.
    - Implementation: Extend extract_banned_ips() to accept server context.

Monitoring and inspections:
  Ban count by time period:
    âœ” Implemented for all fixed periods. @done(25-08-14 10:15)
  Geo-location of banned IPs:
    âœ” Country and city lookup via GeoIP2. @done(25-08-14 10:15)
    âœ” Unknown city â†’ display country. @done(25-08-14 10:15)
  World map visualization:
    âœ” Countries with bans â†’ unique color. @done(25-08-14 10:15)
    âœ” Countries without bans â†’ white. @done(25-08-14 10:15)
    âœ” Legend with country and count. @done(25-08-14 10:15)
  Support for other jails (nginx, postfix, etc.):
    - Planned: Not implemented. Can extend get_service_status() and add jail selection.

Formatting and UX:
  Button labels and icons:
    âœ” "ğŸ“ˆ Compare", "ğŸŒ Geo Stats", "ğŸ”„ Select another period". @done(25-08-14 10:15)
    âœ” Icon consistency and visual clarity. @done(25-08-14 10:15)
  Message formatting:
    âœ” Markdown for /status. @done(25-08-14 10:15)
    âœ” Embedded plots with captions. @done(25-08-14 10:15)
  Logging formatting:
    âœ” Per-field coloring (asctime, levelname, name). @done(25-08-14 10:15)
    âœ” Level-specific icons in logs (ğŸŸ¢ INFO, âš ï¸ WARNING, etc.). @planned
  Pagination for long geo lists:
    - Planned: Not needed yet, but could be added if legend becomes too large.

Logging and debugging:
  Centralized logging:
    âœ” Logs in fail2ban_bot.log with rotation. @done(25-08-14 10:15)
    âœ” Console coloring by level. @done(25-08-14 10:15)
    âœ” Suppressed httpx/urllib3 DEBUG logs. @done(25-08-14 10:15)
  JSON logging for ELK/Splunk:
    - Planned: Not implemented. Can be added via python-json-logger.
  Log cleanup:
    âœ” Remove old /tmp/*.png on startup. @planned
    - Will prevent disk pollution.

Infrastructure and dependencies:
  Docker support:
    âœ” Dockerfile with slim base image. @done(25-08-14 10:15)
    âœ” Multi-stage system dependencies (libproj, libgeos). @done(25-08-14 10:15)
    âœ” Volume mounts for logs and geoip. @done(25-08-14 10:15)
  CI/CD pipeline:
    - Planned: Not implemented. Can be added via GitHub Actions:
    - Linting (ruff, mypy)
    - Docker build and push to registry
    - Release automation
  Requirements management:
    âœ” requirements.txt with pinned versions. @done(25-08-14 10:15)

Release and documentation:
  GitHub repository:
    âœ” Initialized with .gitignore, LICENSE (MIT). @done(25-08-14 10:15)
  README.md:
    âœ” Comprehensive guide with setup, commands, and Docker. @done(25-08-14 10:15)
  Versioning and release:
    âœ” v1.0.0 released on GitHub. @done(25-08-14 10:15)
  Project topics:
    âœ” Added relevant GitHub topics for discoverability. @done(25-08-14 10:15)
